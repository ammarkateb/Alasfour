# Alasfour Flutter App - Architecture Rules

## ğŸ“ Folder Structure
```
lib/
â”œâ”€â”€ controllers/          # Screen controllers (ChangeNotifier)
â”œâ”€â”€ services/            # Business logic services
â”œâ”€â”€ models/              # Data models
â”œâ”€â”€ screens/             # UI screens
â”œâ”€â”€ widgets/             # Reusable UI components
â””â”€â”€ utils/               # Utility functions
```

## ğŸ—ï¸ Architecture Principles

### 1. Controller State Management
- âœ… **Each screen gets its own controller**
- âœ… **Controllers extend ChangeNotifier**
- âœ… **State lives in controllers, not UI**
- âœ… **UI widgets are "dumb" - only render controller state**
- âœ… **Screens use ChangeNotifierProvider + Consumer**

### 2. Product Management
- âœ… **Central ProductService singleton**
- âœ… **All product logic in one place**
- âœ… **No hardcoded product data in screens**
- âœ… **Real-time synchronization across app**

### 3. Type Safety
- âœ… **Use List<Product> never List<Map<String, dynamic>>**
- âœ… **Strongly-typed models everywhere**
- âœ… **No index-based data access**
- âœ… **Pass Product objects, not indices**

### 4. Component Reusability
- âœ… **Extract repeated UI into widgets/**
- âœ… **ProductImage, PriceTag, AddToCartButton, etc.**
- âœ… **DRY principle - Don't Repeat Yourself**
- âœ… **Change once, update everywhere**

### 5. Screen-Controller Mapping
```
ProductsScreen â†’ ProductsController
CartScreen â†’ CartController
NotificationsScreen â†’ NotificationsController
ProfileScreen â†’ ProfileController
QRScannerScreen â†’ QRScannerController
LoginScreen â†’ LoginController
FinalScreen â†’ FinalScreenController
IntroScreen â†’ IntroScreenController
```

## ğŸ“ Naming Conventions

### Controllers
- **File:** `snake_case_controller.dart`
- **Class:** `PascalCaseController`
- **Example:** `products_controller.dart` â†’ `ProductsController`

### Screens
- **File:** `snake_case_screen.dart`
- **Class:** `PascalCaseScreen`
- **Example:** `products_screen.dart` â†’ `ProductsScreen`

### Models
- **File:** `snake_case.dart`
- **Class:** `PascalCase`
- **Example:** `product.dart` â†’ `Product`

### Widgets
- **File:** `snake_case.dart`
- **Class:** `PascalCase`
- **Example:** `product_card.dart` â†’ `ProductCard`

### Services
- **File:** `snake_case.dart`
- **Class:** `PascalCase`
- **Example:** `product_service.dart` â†’ `ProductService`

## ğŸ”„ Data Flow

### 1. Product Details Navigation
```
User taps product â†’ controller.selectProduct(index) â†’ 
Navigator.pushNamed('/product-details', arguments: product) â†’ 
DetailsScreen receives Product object
```

### 2. Cart Operations
```
User action â†’ CartController method â†’ ProductService â†’ 
UI updates via notifyListeners()
```

### 3. State Updates
```
Controller changes state â†’ notifyListeners() â†’ 
Consumer widgets rebuild â†’ UI updates
```

## ğŸ¯ Implementation Checklist

### For Each Screen:
- [ ] Has dedicated controller
- [ ] Uses ChangeNotifierProvider
- [ ] Uses Consumer for state
- [ ] No business logic in UI
- [ ] All async calls in controller

### For Product Features:
- [ ] Uses ProductService
- [ ] Uses Product model
- [ ] No hardcoded data
- [ ] Type-safe navigation
- [ ] Reusable components

### For Components:
- [ ] Extracted to widgets/
- [ ] Reusable across screens
- [ ] Configurable parameters
- [ ] No hardcoded styles

## ğŸš€ Do's and Don'ts

### âœ… Do:
- Create controller for each screen
- Use ProductService for all product operations
- Pass Product objects, not indices
- Extract repeated UI into components
- Follow naming conventions
- Keep screens focused on layout

### âŒ Don't:
- Mix business logic with UI
- Use Map<String, dynamic> for products
- Hardcode product data in screens
- Repeat UI code across screens
- Access data by index
- Skip controller for complex screens

## ğŸ“‹ Quality Standards

### Code Quality:
- âœ… Zero compilation errors
- âœ… Proper error handling
- âœ… Loading states
- âœ… Type safety
- âœ… Clean architecture

### User Experience:
- âœ… Real-time updates
- âœ… Smooth navigation
- âœ… Clear feedback
- âœ… Consistent UI
- âœ… Professional design

### Maintainability:
- âœ… Easy to extend
- âœ… Easy to test
- âœ… Easy to modify
- âœ… Well documented
- âœ… Consistent patterns

---

**Manager Requirements:**
1. âœ… Controller state management
2. âœ… Product management  
3. âœ… List models & list index
4. âœ… Product components
5. âœ… Follow Rule.txt
6. âœ… Controller for each screen

**Status: ALL IMPLEMENTED âœ…**
